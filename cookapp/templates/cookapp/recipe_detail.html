<!-- recipe_detail.html -->

{% extends "cookapp/base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <!-- Recipe Title Section -->
    <div class="recipe-header text-center py-3 mb-5" style="background-color: #f7f7f7; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <h1 class="display-4 font-weight-bold" style="color: #34495e;">{{ recipe.title }}</h1>
        {% if recipe.image %}
            <img src="{{ recipe.image }}" alt="{{ recipe.title }}" class="img-fluid my-4" style="max-width: 500px; height: auto; border-radius: 15px; box-shadow: 0 6px 10px rgba(0,0,0,0.15);">
        {% endif %}
    </div>

    <!-- Ingredients Section -->
    <div class="ingredients-section py-4 px-5 mb-5" style="background-color: #eaf2f8; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <h3 class="font-weight-bold mb-4" style="color: #2874a6;">Ingredients</h3>
        <ul class="list-group">
            {% for recipe_ingredient in recipe.recipeingredient_set.all %}
                <li class="list-group-item" style="border: none; background-color: #d6eaf8; border-radius: 5px; margin-bottom: 8px;">
                    <i class="fa fa-check-circle" style="color: #2ecc71; margin-right: 8px;"></i> 
                    {{ recipe_ingredient.quantity }} {{ recipe_ingredient.ingredient.name }}
                </li>
            {% endfor %}
        </ul>
    </div>

    <!-- Instructions Section -->
    <div class="instructions-section py-4 px-5 mb-5" style="background-color: #fdfefe; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        <h3 class="font-weight-bold mb-4" style="color: #2874a6;">Instructions</h3>
        <ol style="line-height: 1.8; color: #2c3e50;">
            {% for instruction in instructions_list %}
                <li>{{ instruction }}</li>
            {% endfor %}
        </ol>
    </div>

    <!-- Nutrition Information Section -->
    {% if recipe.calories or recipe.macros %}
        <div class="nutrition-section py-4 px-5 mb-5" style="background-color: #e8f8f5; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <h3 class="font-weight-bold mb-4" style="color: #2874a6;">Nutrition Information</h3>
            <ul class="list-group">
                {% if recipe.calories %}
                    <li class="list-group-item" style="border: none; background-color: #d1f2eb; border-radius: 5px; margin-bottom: 8px;">
                        <strong>Calories:</strong> {{ recipe.calories }} kcal
                    </li>
                {% endif %}
                {% if recipe.macros %}
                    {% for macro, value in recipe.macros.items %}
                        <li class="list-group-item" style="border: none; background-color: #d1f2eb; border-radius: 5px; margin-bottom: 8px;">
                            <strong>{{ macro|title }}:</strong> {{ value }} g
                        </li>
                    {% endfor %}
                {% endif %}
            </ul>
        </div>
    {% endif %}

    <!-- Tags Section -->
    {% if recipe.tags %}
        <div class="tags-section text-center py-3 px-5 mb-5" style="background-color: #f5f5f5; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
            <h4 class="font-weight-bold mb-3" style="color: #2874a6;">Tags</h4>
            <p>
                {% for tag in recipe.tags %}
                    <span class="badge badge-pill" style="background-color: #3498db; color: white; padding: 8px 15px; font-size: 14px; margin: 3px;">{{ tag }}</span>
                {% endfor %}
            </p>
        </div>
    {% endif %}

    <!-- Favorite Button -->
    <div class="text-center mb-5">
        {% if user.is_authenticated %}
            <form action="{% url 'toggle_favorite' recipe.id %}" method="post">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary">
                    {% if is_favorited %}Remove from Favorites{% else %}Add to Favorites{% endif %}
                </button>
            </form>
        {% else %}
            <a href="{% url 'login' %}?next={{ request.path }}" class="btn btn-primary">Log in to add to Favorites</a>
        {% endif %}
    </div>
</div>
{% endblock %}
